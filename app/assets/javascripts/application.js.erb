// This is a manifest file that'll be compiled into application.js, which will include all the files
// listed below.
//
// Any JavaScript/Coffee file within this directory, lib/assets/javascripts, vendor/assets/javascripts,
// or vendor/assets/javascripts of plugins, if any, can be referenced here using a relative path.
//
// It's not advisable to add code directly here, but if you do, it'll appear at the bottom of the
// compiled file.
//
// Read Sprockets README (https://github.com/sstephenson/sprockets#sprockets-directives) for details
// about supported directives.
//
//= require jquery
//= require jquery_ujs
//= require jsapi
//= require bootstrap-sprockets
//= require turbolinks
//= require bootstrap
//= require chosen.proto
//= require chosen.jquery
//= require links.js
//= require_tree .


$(document).ready(function() {
  if ($('.pagination').length > 0 && $('#links-list').length > 0 ) {
    $(window).scroll(function() {
      var url = $('.pagination .next_page').attr('href');
         if (url && $(window).scrollTop() > $(document).height() - $(window).height() - 50) {
          $('.pagination').html('<img src= "<%= asset_path('load.gif')%>" style="margin-bottom: 10px; margin-left: 400px"/>')
          return $.getScript(url);
          }
        });
      return $(window).scroll();
      }

  var res_arr = [];
  $('.btn-group').click(function(){
        $('#'+this.id).toggleClass('open');
      }
  )
  $('.view_desc_more').click(function () {
    $('.truncate_desc'+this.id).toggleClass('hide_me');
    $('.truncate_desc_show'+this.id).toggleClass('show_me');
    var v = $( ".truncate_desc_show"+this.id).find("p");
    v.append($('.'+this.id));
  })
  $('.view_desc_less').click(function () {
    $('.truncate_desc'+this.id).toggleClass('hide_me');
    $('.truncate_desc_show'+this.id).toggleClass('show_me');
  })
  $('.cb_select:checkbox').click(function() {
    var $this = $(this);
    if ($this.is(':checked')) {
      res_arr.push($this.val());
    } else {
      res_arr.pop($this.val());
    }

    if(res_arr.length > 0){
      $('.sender').fadeIn( "slow");
    }else{
      $('.sender').fadeOut( "slow");
    }
    return res_arr;
  });

  $('.send_btn').click(function(){
    $.ajax({
      type: "POST",
      url: "links/list_selected",
      data: {link_ids: res_arr}
    } ).done(function(){
    })

  });

  $('.dlt_btn').click(function(){
    $.ajax({
      type: "POST",
      url: "links/remove_selected",
      data: {link_ids: res_arr}
    } ).done(function(){
    })
  });

  });
